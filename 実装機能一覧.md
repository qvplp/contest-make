# 実装機能一覧

## 認証機能
- **ログイン** (`/login`)
  - メールアドレス・パスワードログイン
  - Google/Twitterソーシャルログイン（モック）
  - 認証状態のlocalStorage保存・復元

- **新規登録** (`/signup`)
  - ユーザー名、メールアドレス、パスワード登録
  - パスワード確認・バリデーション
  - 利用規約同意チェック

## ホームページ (`/`)
- **ヒーロースライダー**
  - 自動再生スライダー（10秒間隔）
  - 複数スライド対応
  - CTAボタン

- **コンテストセクション**
  - 開催中コンテスト一覧表示
  - 締切日、参加者数、賞金額表示

- **攻略記事セクション**
  - 人気記事の一覧表示
  - タブ切り替え（すべて、HOT、アニメ、実写）
  - 閲覧数、いいね数、投稿日時表示

- **作品セクション**
  - 投稿作品の一覧表示

## コンテスト機能

### コンテスト一覧 (`/contests`)
- 開催中・近日開催・終了コンテストの一覧
- ステータスフィルター（すべて、開催中、近日開催、終了）
- 検索機能
- 賞金額、応募数、投票数表示

### コンテスト詳細 (`/contest/halloween2025`)
- ヒーローセクション（背景画像、タイトル、説明）
- 統計情報（総賞金額、応募作品数、総投票数）
- スケジュールタイムライン
- 賞金・賞の情報（最優秀賞、優秀賞、特別賞、カテゴリー賞）
- 作品投稿規定
- 関連攻略記事表示（ContestGuidesViewer）
- 応募中の作品グリッド表示
- CTAセクション（応募・投票ボタン）

### 作品応募 (`/contest/halloween2025/submit`)
- ファイルアップロード（画像・動画対応、最大300MB）
  - ドラッグ&ドロップ対応
  - プレビュー表示
- 作品タイトル・説明入力
- 応募カテゴリー選択（複数選択可）
- 作品部門選択（イラスト/アニメ短編）
- バリデーション
- 確認モーダル
- 応募成功モーダル

### 投票機能 (`/contest/halloween2025/vote`)
- 応募作品一覧表示
- ソート機能（得票数順/新着順）
- カテゴリーフィルター
- 作品部門フィルター
- 作品詳細モーダル
- 投票機能（いいね）
- シェア機能

## 攻略記事機能

### 記事一覧 (`/guides`)
- 記事カード表示（サムネイル、タイトル、概要、著者、統計）
- 分類タブ（すべて、HOT、アニメ、漫画、実写、カメラワーク、ワークフロー、AIモデル、コンテスト）
  - 複数選択可能
  - URLパラメータで状態管理
- AIモデル絞り込み（AIモデルタブ選択時）
- カテゴリーフィルター
- 検索機能（タイトル、概要、タグ、AIモデル）
- ソート機能（人気順/新着順）
- マッチ数による優先表示

### 記事詳細 (`/guides/[id]`)
- 記事本文表示（Markdownレンダリング）
- プロンプト例表示（コピー機能付き）
- いいね・コメント機能
- シェア機能
- 引用機能（作品を引用）
- 引用された作品セクション表示
- 引用した記事セクション表示
- コメント投稿・表示

### 記事投稿 (`/guides/new`)
- **第1ページ：コンテンツ作成**
  - サムネイル画像アップロード
  - タイトル・概要入力
  - セクション管理エディタ
    - 複数セクションの追加・削除・並び替え（ドラッグ&ドロップ）
    - 各セクションの公開/非公開設定
    - Markdownエディタ
    - ライブプレビュー
  - 引用した記事の追加（記事ID入力）
  - 自動保存機能（useAutoSave）
  - 下書き履歴機能
  - ページ離脱ガード（未保存変更の警告）
  - 全体プレビューモーダル

- **第2ページ：設定** (`/guides/new/settings`)
  - カテゴリー選択
  - 分類選択（複数選択可）
  - AIモデル選択（複数選択可）
  - タグ追加・削除
  - コンテストタグ選択
  - 記事プレビュー表示
  - 全体プレビューモーダル
  - 投稿実行

### 記事引用機能 (`/guides/[id]/cite`)
- 自分の作品一覧表示
- 複数作品の選択
- 選択した作品を記事に引用
- localStorageに保存

## 作品投稿・閲覧機能

### 作品一覧 (`/contest-posts`)
- 作品グリッド表示
- 分類タブ（すべて、HOT、アニメ、漫画、実写、カメラワーク、ワークフロー、AIモデル）
- AIモデル絞り込み
- 検索機能
- ソート機能（人気順/新着順）
- 無限スクロール（Intersection Observer）
- 画像/動画の区別表示
- HOTバッジ表示

## プロフィール機能

### プロフィール表示 (`/profile`)
- ユーザー情報表示（アバター、ユーザー名、自己紹介、SNSリンク）
- 統計情報（フォロワー数、フォロー中数）
- 受賞履歴表示（バッジ表示）
- タブ切り替え
  - **攻略記事タブ**：投稿した記事一覧
  - **投稿作品タブ**：投稿した作品一覧
  - **通知タブ**：通知一覧（いいね、コメント、コンテスト、フォロー、システム通知）
    - 未読数表示
    - 既読/未読の区別
    - 時間表示（相対時間）

### プロフィール編集 (`/profile/edit`)
- プロフィール画像アップロード
- ユーザー名編集
- 自己紹介編集
- SNSリンク編集（Twitter、Instagram、ポートフォリオ）

## 決済設定 (`/settings/payment`)
- クレジット残高表示
- クレジット購入プラン選択
- 購入履歴表示

## 共通コンポーネント・機能

### ヘッダー
- 検索バー
- 通知アイコン（未読数表示）
- ログイン状態に応じた表示切り替え
- モバイルメニューボタン

### 認証コンテキスト
- ログイン状態管理
- ユーザー情報管理
- localStorage連携

### エディタ機能
- **MarkdownEditor**：Markdown編集
- **MarkdownPreview**：Markdownプレビュー（シンタックスハイライト付き）
- **SectionManager**：セクション管理（追加・削除・並び替え・公開設定）
- **DraftHistoryModal**：下書き履歴表示・復元

### ユーティリティ
- **自動保存**（useAutoSave）：定期的な下書き保存
- **ページ離脱ガード**（useUnloadGuard）：未保存変更の警告
- **下書き管理**（draftManager）：localStorageでの下書き保存・復元
- **Markdown処理**：Markdownのパース・レンダリング

### レスポンシブ対応
- モバイル・タブレット・デスクトップ対応
- ブレークポイントに応じたレイアウト調整

## 技術スタック
- **フレームワーク**: Next.js 16 (App Router)
- **言語**: TypeScript
- **スタイリング**: Tailwind CSS 4
- **UIライブラリ**: Lucide React（アイコン）
- **Markdown**: marked, react-syntax-highlighter, prismjs
- **ドラッグ&ドロップ**: @dnd-kit
- **画像最適化**: Next.js Image
- **状態管理**: React Context API

## データ管理
- **認証**: localStorage（モック）
- **下書き**: localStorage
- **引用データ**: localStorage
- **バックエンド**: 未実装（すべてフロントエンドのみ）

## 注意事項
- バックエンドAPIは未実装のため、すべてのデータはモックデータまたはlocalStorageで管理
- 実際のAPI連携が必要な箇所にはTODOコメントが記載されている
- 認証機能はモック実装（実際の認証APIは未実装）

## システム要件・追加仕様サマリ

### 認証・アクセス制御
- ホーム画面(`/`)を含む主要ページは、`AuthContext`の`isLoggedIn`フラグで保護されており、**未ログイン時は自動的に`/login`へリダイレクト**される
- 認証状態は`localStorage`キー`animehub_user`に保存され、リロード後も復元される
- `/login` `/signup`は誰でもアクセス可能な公開ページ
- コンテスト応募ページ(`/contest/halloween2025/submit`)、投票ページ(`/contest/halloween2025/vote`)、記事投稿関連(`/guides/new`, `/guides/new/settings`)、引用ページ(`/guides/[id]/cite`)、プロフィール関連(`/profile`, `/profile/edit`)などは**ログイン必須**で、未ログイン時は`/login`に遷移しコンテンツは表示しない

### 記事下書き・自動保存
- 記事投稿フローでは、`draftManager`と`useAutoSave`により、タイトル・セクション・概要・サムネイル・引用記事情報を**localStorage下書きとして自動保存**する
- 自動保存は「入力停止から約1.5秒後のデバウンス保存」と「10秒間隔の定期保存」によって行われ、変更がない場合はハッシュ比較により保存をスキップする
- 各記事にはバージョン番号付きの下書きが保存され、直近最大5件分の履歴メタデータ（バージョン・タイムスタンプ・セクション数など）が履歴として保持される
- `useUnloadGuard`により、未保存の変更がある場合にページ離脱時(`beforeunload`)に警告を表示する

### Markdown処理とセキュリティ
- 記事本文は`marked`でMarkdown→HTMLに変換したうえで、`DOMPurify`により**サニタイズ**されてからレンダリングされる
- 許可タグ・許可属性を限定することで、スクリプト挿入などのXSSリスクを低減している
- コードブロックはカスタムレンダラーにより`<pre><code>`形式で装飾され、シンタックスハイライト用のクラスが付与される

### ローカルストレージ利用ポリシー
- 認証ユーザー情報: `animehub_user`
- 記事下書き: `draft:{articleId}`
- 記事下書き履歴: `history:{articleId}`
- 記事設定(カテゴリ・分類・AIモデル・タグ・コンテストタグ): `settings:{articleId}`
- 記事に紐づく引用作品一覧: `guide_citations_{guideId}`
